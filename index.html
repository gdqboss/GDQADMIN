<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>å½©ç¾ç‰¹ä¼ä¸šç®¡ç†å·¥ä½œå°</title>
<style>
* {box-sizing:border-box;margin:0;padding:0}
body {font-family:-apple-system,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}
.login {padding:50px 20px}
.login-card {background:white;border-radius:20px;padding:30px;max-width:350px;margin:0 auto;box-shadow:0 20px 60px rgba(0,0,0,0.3)}
.logo {width:80px;height:80px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:20px;margin:0 auto 20px;display:flex;align-items:center;justify-content:center;font-size:40px}
h2 {margin-bottom:5px;color:#333}
input {width:100%;padding:14px;border:1px solid #ddd;border-radius:10px;margin-bottom:15px;font-size:15px}
.btn {width:100%;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:white;border:none;border-radius:10px;font-size:16px;cursor:pointer}
.menu {display:grid;grid-template-columns:repeat(2,1fr);gap:15px;padding:20px}
.menu a {background:white;border-radius:16px;padding:20px;text-align:center;text-decoration:none;display:block;box-shadow:0 4px 15px rgba(0,0,0,0.1)}
.menu-icon {width:50px;height:50px;border-radius:14px;margin:0 auto 10px;display:flex;align-items:center;justify-content:center;font-size:24px}
.menu h6 {color:#333;font-size:14px;margin-bottom:3px}
.menu p {color:#999;font-size:11px}
.header {background:linear-gradient(135deg,#667eea,#764ba2);color:white;padding:15px;display:flex;justify-content:space-between;align-items:center}
.header h3 {font-size:16px}
.lang-btn {background:none;border:1px solid white;border-radius:5px;color:white;padding:5px 10px;font-size:12px;cursor:pointer}
</style>
</head>
<body>
<div id="loginPage">
<div class="login">
<div class="login-card">
<div class="logo">ğŸŸ</div>
<h2>å½©ç¾ç‰¹ä¼ä¸š</h2>
<p style="color:#666;margin-bottom:20px">ç®¡ç†å·¥ä½œå°</p>
<input id="username" placeholder="ç”¨æˆ·å">
<input id="password" type="password" placeholder="å¯†ç ">
<button class="btn" onclick="doLogin()">ç™»å½•</button>
</div>
</div>

<div id="homePage" style="display:none">
<div class="header">
<h3>ğŸŸ å½©ç¾ç‰¹ä¼ä¸š</h3>
<div>
<select id="langSelect" onchange="setLang(this.value)" style="padding:5px;border-radius:5px;border:none">
<option value="zh">ä¸­æ–‡</option>
<option value="en">EN</option>
<option value="ja">æ—¥æœ¬èª</option>
</select>
<button onclick="logout()" style="background:none;border:none;color:white;margin-left:10px;font-size:14px">é€€å‡º</button>
</div>
</div>

<div class="menu">
<a href="/ai-chat/"><div class="menu-icon" style="background:#e8f5e9">ğŸ’¬</div><h6>èŠå¤©å®¤</h6><p>å›¢é˜Ÿæ²Ÿé€š</p></a>
<a href="/qrcode_stats.html"><div class="menu-icon" style="background:#e3f2fd">ğŸ·ï¸</div><h6>ä¸€ç‰©ä¸€ç </h6><p>è¿½æº¯ç³»ç»Ÿ</p></a>
<a href="/inventory_stats.html"><div class="menu-icon" style="background:#fff3e0">ğŸ“¦</div><h6>è¿›é”€å­˜</h6><p>åº“å­˜ç®¡ç†</p></a>
<a href="/commune/admin.html" id="adminLink" style="display:none"><div class="menu-icon" style="background:#f3e5f5">âš™ï¸</div><h6>ç®¡ç†åå°</h6><p>ç³»ç»Ÿç®¡ç†</p></a>
</div>
</div>

<script>
var lang = localStorage.getItem('lang') || 'zh';
document.getElementById('langSelect').value = lang;

function doLogin(){
var u=document.getElementById('username').value;
var p=document.getElementById('password').value;
if(!u||!p){alert('è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ');return;}
var fd=new FormData();
fd.append('username',u);fd.append('password',p);
fetch('/api/commune/user.php?action=login',{method:'POST',body:fd})
.then(r=>r.json()).then(d=>{
if(d.code===1){localStorage.setItem('gdq_user',JSON.stringify(d.data));showHome();}
else{alert(d.msg);}
});
}

function showHome(){
document.getElementById('loginPage').style.display='none';
document.getElementById('homePage').style.display='block';
var user=JSON.parse(localStorage.getItem('gdq_user'));
if(user.role==='admin'){document.getElementById('adminLink').style.display='block';}
}

function logout(){localStorage.removeItem('gdq_user');location.reload();}

function setLang(lang){
localStorage.setItem('lang',lang);
alert('è¯­è¨€å·²åˆ‡æ¢ä¸º: '+(lang==='zh'?'ä¸­æ–‡':lang=='en'?'English':'æ—¥æœ¬èª'));
}

var user=localStorage.getItem('gdq_user');
if(user){showHome();}
</script>
</body>
</html>

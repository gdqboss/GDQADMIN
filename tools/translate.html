<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>æ™ºèƒ½ç¿»è¯‘ - å½©ç¾ç‰¹</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: -apple-system, sans-serif; background: #f5f7fa; min-height: 100vh; }
.header { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; text-align: center; }
.header h1 { font-size: 20px; margin-bottom: 5px; }
.header a { color: white; text-decoration: none; font-size: 14px; }

.container { max-width: 800px; margin: 20px auto; padding: 0 15px; }

.card { background: white; border-radius: 16px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }

.language-selector { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
.language-selector select { padding: 10px 15px; border: 1px solid #ddd; border-radius: 10px; font-size: 15px; background: white; }
.swap-btn { width: 40px; height: 40px; border-radius: 50%; background: #f0f0f0; border: none; font-size: 18px; cursor: pointer; }

textarea { width: 100%; height: 150px; padding: 15px; border: 1px solid #ddd; border-radius: 12px; font-size: 16px; resize: none; outline: none; }
textarea:focus { border-color: #667eea; }

.translate-btn { width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 12px; font-size: 16px; cursor: pointer; margin-top: 15px; }

.result { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 12px; }
.result-label { font-size: 12px; color: #888; margin-bottom: 8px; }
.result-text { font-size: 16px; line-height: 1.6; }
.copy-btn { float: right; background: none; border: none; color: #667eea; cursor: pointer; font-size: 14px; }

.history { }
.history-item { padding: 12px; border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center; }
.history-item:last-child { border-bottom: none; }
.history-text { flex: 1; font-size: 14px; }
.history-lang { font-size: 12px; color: #888; margin-left: 10px; }

.detect-btn { padding: 8px 15px; background: #4caf50; color: white; border: none; border-radius: 8px; cursor: pointer; margin-top: 10px; }
</style>
</head>
<body>
<div class="header">
<h1>ğŸˆ¶ æ™ºèƒ½ç¿»è¯‘</h1>
<a href="/">â† è¿”å›ä¸»é¡µ</a>
</div>

<div class="container">
<div class="card">
<div class="language-selector">
<select id="from-lang">
<option value="auto">è‡ªåŠ¨æ£€æµ‹</option>
<option value="zh" selected>ä¸­æ–‡</option>
<option value="en">è‹±è¯­</option>
<option value="yue">ç²¤è¯­</option>
<option value="ja">æ—¥è¯­</option>
<option value="ko">éŸ©è¯­</option>
<option value="es">è¥¿ç­ç‰™è¯­</option>
<option value="fr">æ³•è¯­</option>
<option value="de">å¾·è¯­</option>
<option value="ru">ä¿„è¯­</option>
<option value="th">æ³°è¯­</option>
<option value="vi">è¶Šå—è¯­</option>
<option value="ms">é©¬æ¥è¯­</option>
<option value="id">å°å°¼è¯­</option>
</select>
<button class="swap-btn" onclick="swapLang()">â‡„</button>
<select id="to-lang">
<option value="zh" selected>ä¸­æ–‡</option>
<option value="en">è‹±è¯­</option>
<option value="yue">ç²¤è¯­</option>
<option value="ja">æ—¥è¯­</option>
<option value="ko">éŸ©è¯­</option>
<option value="es">è¥¿ç­ç‰™è¯­</option>
<option value="fr">æ³•è¯­</option>
<option value="de">å¾·è¯­</option>
<option value="ru">ä¿„è¯­</option>
<option value="th">æ³°è¯­</option>
<option value="vi">è¶Šå—è¯­</option>
<option value="ms">é©¬æ¥è¯­</option>
<option value="id">å°å°¼è¯­</option>
</select>
</div>

<textarea id="input-text" placeholder="è¯·è¾“å…¥è¦ç¿»è¯‘çš„æ–‡å­—..."></textarea>
<button class="translate-btn" onclick="translate()">ğŸ”„ ç¿»è¯‘</button>

<div class="result" id="result" style="display:none">
<div class="result-label">ç¿»è¯‘ç»“æœ <button class="copy-btn" onclick="copyResult()">ğŸ“‹ å¤åˆ¶</button></div>
<div class="result-text" id="result-text"></div>
</div>
</div>

<div class="card">
<h3>ğŸ“ ç¿»è¯‘å†å²</h3>
<div id="history"></div>
</div>
</div>

<script>
var history = [];

function swapLang() {
    var from = document.getElementById('from-lang');
    var to = document.getElementById('to-lang');
    var temp = from.value;
    from.value = to.value;
    to.value = temp;
}

function translate() {
    var text = document.getElementById('input-text').value.trim();
    if (!text) { alert('è¯·è¾“å…¥è¦ç¿»è¯‘çš„æ–‡å­—'); return; }
    
    var from = document.getElementById('from-lang').value;
    var to = document.getElementById('to-lang').value;
    
    var fd = new FormData();
    fd.append('text', text);
    fd.append('from', from);
    fd.append('to', to);
    
    document.querySelector('.translate-btn').textContent = 'ç¿»è¯‘ä¸­...';
    
    fetch('/api/translate.php?action=translate', { method: 'POST', body: fd })
    .then(r => r.json())
    .then(d => {
        document.querySelector('.translate-btn').textContent = 'ğŸ”„ ç¿»è¯‘';
        if (d.code === 1) {
            document.getElementById('result').style.display = 'block';
            document.getElementById('result-text').textContent = d.data.text;
            
            // æ·»åŠ åˆ°å†å²
            history.unshift({ from, to, text, result: d.data.text });
            if (history.length > 10) history.pop();
            renderHistory();
        } else {
            alert(d.msg || 'ç¿»è¯‘å¤±è´¥');
        }
    });
}

function copyResult() {
    var text = document.getElementById('result-text').textContent;
    navigator.clipboard.writeText(text).then(() => alert('å·²å¤åˆ¶'));
}

function renderHistory() {
    var html = '';
    history.forEach(function(h) {
        html += '<div class="history-item">' +
            '<div class="history-text">' + h.text.substring(0, 30) + '... â†’ ' + h.result.substring(0, 30) + '...</div>' +
            '<div class="history-lang">' + h.from + ' â†’ ' + h.to + '</div></div>';
    });
    document.getElementById('history').innerHTML = html || 'æš‚æ— å†å²';
}
</script>
</body>
</html>
